{% extends 'base.html' %}
{% block content %}

<h2>{{ user.fname}} {{user.lname}}'s profile</h2>
Email: {{ user.email }}
<br>
Phone: {{ user.phone }}
<br>

<!-- Contacts list, with events -->
<p class='green'> People {{user.fname}} Will Keep in Touch With</p>
<ol> {% for contact in user.contacts %}
    <li> 
        {{ contact.name }} 

        {% if contact.user_id == session.get('user_id') %}
            <a href="/remove_contact/{{contact.id}}" style='font-size: 12px'><b>delete contact and events</b></a>
        {% endif %} 
    </li> 
        <ul> {% for event in contact.events %}
            <li>{{ event.template.name }} ({{event.date}}) 
                {% if contact.user_id == session.get('user_id') %}
                    <a href="/edit_event/{{event.id}}" style='font-size: 12px'><b>view/modify event</b></a>
                {% endif %} 
            </li>
        {% endfor %} 
        </ul>
    {% endfor %}
</ol>



<!-- Table of events -->
<p class='green'> {{user.fname}}'s Events</p>
<table cellspacing="15">
    <tr>
        <th><u>Contact Name</u></th>
        <th><u>Email</u></th>
        <th><u>Phone</u></th>
        <th><u>Template</u></u></th>
        <th><u>Date (to be sent)</u></th>
        <th></th> <!-- "empty" row for view/modify link for each event  -->
    </tr>
    <tr> 
    {% for contact in user.contacts %}
    {% for event in contact.events %}
        <td> {{ contact.name }} </td>
        <td> {{ contact.email }}</td>
        <td> {{ contact.phone }}</td>
        <td> {{event.template.name}} message </td>
        <td> {{ event.date}} </td>
        <td>{% if contact.user_id == session.get('user_id') %}<a href="/edit_event/{{event.id}}">view/modify event</a></td>{% endif %} 
    </tr>
    {% endfor %}
    {% endfor %}
</table>

<br>
<br>
<a href="/add_event"> <b>Create a new contact/event</b></a>

{% endblock %}